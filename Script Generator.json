{"files":[{"id":"ff885ceb-848a-42d6-ab7b-cafe5c71b448","name":"Code","type":"server_js","source":"function createDocument() {\n  var headers \u003d Sheets.Spreadsheets.Values.get(\u00271O1vtMD7R5wP94goE-ZdZhyPuqtuWMPIB581f2oulQxM\u0027, \u0027A1:I1\u0027);\n  var tactics \u003d Sheets.Spreadsheets.Values.get(\u00271O1vtMD7R5wP94goE-ZdZhyPuqtuWMPIB581f2oulQxM\u0027, \u0027A2:I1000\u0027);\n  var templateId \u003d \u00271s8m4ixTOnowVwtjedg62GnORDyRNr3QqnMW6HNkAcjA\u0027;\n  \n  for(var i \u003d 0; i \u003c tactics.values.length; i++){\n    \n    var position \u003d tactics.values[i][0];\n    var company \u003d tactics.values[i][1];\n    var contribution \u003d tactics.values[i][2];\n    var summary \u003d tactics.values[i][3];\n    var date \u003d tactics.values[i][4];\n    \n    //Make a copy of the template file\n    var documentId \u003d DriveApp.getFileById(templateId).makeCopy().getId();\n    \n    //Rename the copied file\n    DriveApp.getFileById(documentId).setName(\u0027ChloeHom_CoverLetter_\u0027 + company + \"(\" + position + \")\");\n    a \u003d DriveApp.getFileById(documentId).setName(\u0027ChloeHom_CoverLetter_\u0027 + company + \"(\" + position + \")\");\n\n    //Get the document body as a variable\n    var body \u003d DocumentApp.openById(documentId).getBody();\n    \n  \n    //Insert the supplier name\n    body.replaceText(\u0027##Position##\u0027, position)\n    body.replaceText(\u0027##Company##\u0027, company)\n    body.replaceText(\u0027##Contribution##\u0027, contribution)\n    body.replaceText(\u0027##Summary##\u0027, summary)\n    body.replaceText(\u0027##Date##\u0027, date)  \n    \n   \n  }\n}\n\n\n"},{"id":"03781b6b-7cba-4815-8fcb-5519f3ee8c8c","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Los_Angeles\",\n  \"dependencies\": {\n    \"enabledAdvancedServices\": [{\n      \"userSymbol\": \"Docs\",\n      \"serviceId\": \"docs\",\n      \"version\": \"v1\"\n    }, {\n      \"userSymbol\": \"Sheets\",\n      \"serviceId\": \"sheets\",\n      \"version\": \"v4\"\n    }]\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"94ff6c31-6b5e-487e-acf2-778c41751d7d","name":"pdf code","type":"server_js","source":"function gdocToPDF() {\n    var documentRootfolder \u003d DriveApp.getFolderById(\"1zxIgcLg1nPKraNEKASqJ6_wWBdW77IVx\") // replace this with the ID of the folder that contains the documents you want to convert\n    var pdfFolder \u003d DriveApp.getFolderById(\"1oLfcQUNTPSVKbGU1dgtiZKusI3ZpbJjt\"); // replace this with the ID of the folder that the PDFs should be put in. \n\n    var documentRootFiles \u003d documentRootfolder.getFiles()\n\n    while(documentRootFiles.hasNext()) {\n        createPDF(documentRootFiles.next().getId(), pdfFolder.getId(), function (fileID, folderID) {\n            if (fileID) createPDFfile(fileID, folderID);\n        })\n    }\n}\n\n\nfunction createPDF(fileID, folderID, callback) {\n    var templateFile \u003d DriveApp.getFileById(fileID);\n    var templateName \u003d templateFile.getName();\n    \n    var existingPDFs \u003d DriveApp.getFolderById(folderID).getFiles();\n\n    //in case no files exist\n    if (!existingPDFs.hasNext()) {\n        return callback(fileID, folderID);\n    }\n\n    for (; existingPDFs.hasNext();) {\n\n        var existingPDFfile \u003d existingPDFs.next();\n        var existingPDFfileName \u003d existingPDFfile.getName();\n        if (existingPDFfileName \u003d\u003d templateName + \".pdf\") {\n            Logger.log(\"PDF exists already. No PDF created\")\n            return callback();\n        }\n        if (!existingPDFs.hasNext()) {\n            Logger.log(\"PDF is created\")\n            return callback(fileID, folderID)\n        }\n    }\n}\n\nfunction createPDFfile(fileID, folderID) {\n    var templateFile \u003d DriveApp.getFileById(fileID);\n    var folder \u003d DriveApp.getFolderById(folderID);\n    var theBlob \u003d templateFile.getBlob().getAs(\u0027application/pdf\u0027);\n    var newPDFFile \u003d folder.createFile(theBlob);\n\n    var fileName \u003d templateFile.getName().replace(\".\", \"\"); //otherwise filename will be shortened after full stop    \n    newPDFFile.setName(fileName + \".pdf\");\n}"}]}